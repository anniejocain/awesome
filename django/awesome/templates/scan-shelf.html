<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <meta name="description" content="{{shelf.title}}">
  <meta name="author" content="{{organization.name}}">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}

<title>Scan | Awesome Box at the {{organization.name}}</title>

<link rel="stylesheet" href="{{ STATIC_PREFIX }}css/normalize.css" type="text/css" />
<link rel="stylesheet" href="{{ STATIC_PREFIX }}css/skeleton.css" type="text/css" />
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" href="{{ STATIC_PREFIX }}css/build-shelf.css" type="text/css" />
</head>

<body>
<div class="container">
    <div class="row">
      <div class="eight columns">
      	<h4>Build your shelf</h4>
      	<form id="lookup">
    	<div class="row">
    		<div class="eight columns">
    			<input class="u-full-width" placeholder="ISBN/UPC code" id="barcode" type="text">
    		</div>
    		<div class="four columns">
    			<h5>Add Items</h5>
    			<p class="status"></p>
    		</div>
    	</div>
	</form>
      </div>
    </div>
    <form action="." method="post">
      <div class="row">
      	<div class="eight columns">
      	{% csrf_token %}
      	{% if add_item_form.errors %}
      	<ul class="errorlist">
        	<li>Please fix the error(s) below.</li>
      	</ul>
      	{% endif %}
		<p class="build-shelf-title">{{ form.title }}{{ form.title.errors }}</p>
		<p class="build-shelf-permalink">http://{{shelf.organization.slug}}.{{awesome_domain}}/{{form.slug}}{{form.slug.errors}}</p>
		<p class="build-shelf-description">{{ form.description }}{{ form.description.errors }}</p>
		{{ formset.management_form }}
		</div>
		<div class="four columns">
			<h5>Shelf Details</h5>
			<p>Your shelf's title, link and description</p>
			<button class="button-primary">Save Shelf</button>
			{% if messages %}
        		{% for message in messages %}
            		<p id="build-shelf-message">{% if 'safe' in message.tags %}{{ message|safe }}{% else %}{{ message }}{% endif %}</p>
        		{% endfor %}
    		{% endif %}
		</div>
		</div>
		<div class="row">
		<div class="twelve columns">
		<div class="order_list">
		{% for form in formset.forms %}
		<div class="order_item item" id="item-{{ forloop.counter }}">
		{% for field in form.visible_fields %}

		{# include hidden fields #}
		{% if forloop.first %}
        	{% for hidden in form.hidden_fields %}
        	{{ hidden }}
        	{% endfor %}
		{% endif %}

		{% if "sort_order" in field.html_name %}
		<span class="order">
		{{ field.as_hidden }}
		</span>
		{% elif "shelf" in field.html_name or "id" in field.html_name %}
		<span class="description">
		{{ field.as_hidden }}
		</span>
		{% else %}
		<span class="description">

		{{ field.errors }}
		{{ field }}

		</span>
		{% endif %}

		{% endfor %}
		</div>
		{% endfor %}
		</div>
		</div>
		</div>
		</form>
	<div class="row">
		<div class="twelve columns" id="shelf-items">
		</div>
	</div>
</div>

<script type="text/javascript">
	var CSRF_TOKEN = "{{ csrf_token }}",
	shelf='{{shelf.id}}';
</script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/jquery-1.7.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script src="{{ STATIC_PREFIX }}js/handlebars.js"></script>
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/scan-shelf.js"></script>

</body>

{% verbatim %}
<script id="items-template" type="text/x-handlebars-template"> 
	<div class="item">
		<div class="item-details">
			<p class="item-title">
				{{title}}
			</p>
			<p class="item-author">{{creator}}</p>
			<i class="fa fa-amazon"></i>
		</div>
	</div>
</script>

<script id="items-template2" type="text/x-handlebars-template">
	<div class="order_item item ui-sortable-handle" id="item-{{item_num}}">
	<input id="id_form-{{form_num}}-id" name="form-{{form_num}}-id" value="{{id}}" type="hidden">
	<span class="description">
	<input id="id_form-{{form_num}}-title" maxlength="400" name="form-{{form_num}}-title" value="{{title}}" type="text">
	</span>
	<span class="description">
	<input id="id_form-{{form_num}}-creator" maxlength="400" name="form-{{form_num}}-creator" value="{{creator}}" type="text">
	</span>
	<span class="order hidden">
	<input id="id_form-{{form_num}}-sort_order" name="form-{{form_num}}-sort_order" value="{{sort}}" type="hidden">
	</span>
	<span class="description">
	<input id="id_form-{{form_num}}-shelf" name="form-{{form_num}}-shelf" value="{{shelf}}" type="hidden">
	</span>
	</div>
</script>

{% endverbatim %}